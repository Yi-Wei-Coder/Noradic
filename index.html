<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>2025 ÂåóÊ≠êÊ•µÂÖâ‰πãÊóÖ (Nordic Trip)</title>
    <style>
        :root {
            --primary: #004e66;
            --secondary: #e0f7fa;
            --accent: #ff6f61;
            --bg: #f8f9fa;
            --text: #2c3e50;
            --success: #28a745;
            --danger: #dc3545;
            --warning: #ffc107;
            --price: #85bb65;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 0;
            padding-bottom: 80px;
        }
        header {
            background: linear-gradient(135deg, #004e66 0%, #002a3a 100%);
            color: white;
            padding: 20px;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        h1 { margin: 0 0 5px 0; font-size: 1.4rem; text-align: center; }
        p.subtitle { margin: 0 0 15px; text-align: center; font-size: 0.8rem; opacity: 0.8; }
        
        .controls { display: flex; gap: 10px; }
        .search-box { flex: 1; position: relative; }
        .search-box input {
            width: 100%; padding: 10px 15px 10px 35px;
            border-radius: 20px; border: none; background: rgba(255,255,255,0.95);
            font-size: 15px; box-sizing: border-box;
        }
        .search-icon { position: absolute; left: 12px; top: 50%; transform: translateY(-50%); color: #666; }
        
        .container { max-width: 800px; margin: 15px auto; padding: 0 10px; }

        .day-card {
            background: white; border-radius: 16px; margin-bottom: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05); overflow: hidden;
        }
        
        .day-header {
            padding: 12px 15px; background: #fff; border-bottom: 1px solid #f0f0f0;
            display: flex; justify-content: space-between; align-items: center; cursor: pointer;
        }
        .day-info h2 { margin: 0; font-size: 1.1rem; color: var(--primary); }
        .day-loc { font-size: 0.85rem; color: #666; margin-top: 4px; display: flex; align-items: center; gap: 8px; flex-wrap: wrap; }
        
        .weather-badge {
            font-size: 0.75rem; background: #e3f2fd; color: #1565c0;
            padding: 2px 8px; border-radius: 12px; display: inline-flex; align-items: center;
        }
        .aurora-badge {
            font-size: 0.75rem; background: linear-gradient(45deg, #1a237e, #4a148c); color: #a7ffeb;
            padding: 2px 8px; border-radius: 12px; display: none; margin-left: 5px;
            animation: glow 2s infinite alternate; cursor: pointer;
        }
        @keyframes glow { from { text-shadow: 0 0 2px #a7ffeb; } to { text-shadow: 0 0 8px #a7ffeb; } }

        .day-content { padding: 5px 15px 15px; display: block; }

        .item { display: flex; gap: 12px; margin-top: 15px; position: relative; }
        .item::before {
            content: ''; position: absolute; left: 20px; top: 28px; bottom: -20px;
            width: 2px; background: #f0f0f0; z-index: 0;
        }
        .item:last-child::before { display: none; }

        .time-col { min-width: 45px; text-align: right; z-index: 1; }
        .time { font-size: 0.9rem; font-weight: 700; color: var(--text); background: white; }
        .duration { font-size: 0.65rem; color: #999; display: block; margin-top: 2px; }

        .details-col {
            flex: 1; background: #fafafa; padding: 10px; border-radius: 10px; border: 1px solid #eee;
        }
        .name-row { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 5px; }
        .name { font-weight: 600; font-size: 1rem; color: var(--primary); line-height: 1.3; }
        
        .status-dot { height: 8px; width: 8px; border-radius: 50%; display: inline-block; margin-right: 4px; }
        .status-open { background-color: var(--success); box-shadow: 0 0 4px var(--success); }
        .status-closed { background-color: var(--danger); }
        .status-closing { background-color: var(--warning); }
        .status-text { font-size: 0.7rem; color: #666; font-weight: normal; white-space: nowrap; }

        .tags { display: flex; gap: 5px; flex-wrap: wrap; margin-bottom: 8px; }
        .tag { padding: 2px 6px; border-radius: 4px; font-size: 0.7rem; color: white; }
        .tag.transport { background-color: #5c6bc0; }
        .tag.food { background-color: #ef5350; }
        .tag.spot { background-color: #66bb6a; }
        .tag.hotel { background-color: #455a64; }
        .tag.price { background-color: transparent; border: 1px solid var(--price); color: var(--price); font-weight: bold; }
        
        .transport-detail {
            font-size: 0.75rem; color: #5c6bc0; background: #e8eaf6; 
            padding: 4px 8px; border-radius: 4px; margin-bottom: 6px; display: inline-block;
        }

        .note { font-size: 0.85rem; color: #555; margin-top: 5px; line-height: 1.4; }
        .hours-info { font-size: 0.75rem; color: #888; margin-top: 4px; display: block; border-top: 1px dashed #eee; padding-top: 4px; }

        a { text-decoration: none; color: inherit; }
        
        /* ‰ΩèÂÆøË≥áË®äÂçÄÂ°ä */
        .hotel-info {
            margin-top: 8px; background: #eceff1; padding: 8px; border-radius: 6px;
            font-size: 0.8rem; color: #37474f; display: flex; align-items: center; gap: 6px;
        }
    </style>
</head>
<body>

<header>
    <h1>2025 ÂåóÊ≠êÊ•µÂÖâ‰πãÊóÖ</h1>
    <p class="subtitle">Ë°åÁ®ãËàá‰∫§ÈÄöÂç≥ÊôÇÊü•Èñ±</p>
    <div class="controls">
        <div class="search-box">
            <span class="search-icon">üîç</span>
            <input type="text" id="searchInput" placeholder="ÊêúÂ∞ã (Â¶Ç: È≠öÊπØ, Bus 8, Ê•µÂÖâ...)" onkeyup="filterItinerary()">
        </div>
    </div>
</header>

<div class="container" id="itinerary-container"></div>

<script>
    // ÂüéÂ∏ÇÂ∫ßÊ®ô (Áî®ÊñºÂç≥ÊôÇÂ§©Ê∞£)
    const LOCS = {
        "Oslo": { lat: 59.91, lon: 10.75 },
        "Fl√•m": { lat: 60.86, lon: 7.11 },
        "Bergen": { lat: 60.39, lon: 5.32 },
        "Helsinki": { lat: 60.16, lon: 24.93 },
        "Rovaniemi": { lat: 66.50, lon: 25.72 },
        "Pyh√§": { lat: 67.02, lon: 27.24 },
        "Tallinn": { lat: 59.43, lon: 24.75 },
        "Copenhagen": { lat: 55.67, lon: 12.56 }
    };

    // Ë°åÁ®ãË≥áÊñô (Â∑≤Ë£úÂÖ®‰∫§ÈÄöÁ∑öË∑ØËàáÁ•®ÂÉπ)
    const data = [
        {
            date: "11/29", day: "Sat", loc: "Oslo",
            hotel: "Comfort Hotel Xpress Central Station",
            items: [
                { type: "transport", time: "07:05", name: "ÊäµÈÅîÂ•ßÊñØÈô∏ (TG594)", note: "Ê©üÂ†¥Âø´Á∑ö Flytoget (Ë≤¥) Êàñ Vy Regional (‰æøÂÆú)", duration: "25min", transport: "Êé®Ëñ¶Êê≠ Vy ÁÅ´Ëªä (ÂæÄ Oslo S)" },
                { type: "hotel", time: "Check-in", name: "Comfort Hotel Xpress", note: "Central Station ÊóÅÔºåÊîæË°åÊùé", duration: "" },
                { type: "food", time: "12:00", name: "Fiskeriet Youngstorget", note: "Áü•ÂêçÈ≠öÊπØ/Êµ∑ÈÆÆÔºå‰∫∫Â§öÈúÄÊéíÈöä", price: "Á¥Ñ 200-300 NOK", hours: "12:00-22:00", openRule: {s: [12,22]} },
                { type: "spot", time: "14:00", name: "Â•ßÊñØÈô∏Ê≠åÂäáÈô¢", note: "Ëµ∞Ë∑ØÂèØÈÅîÔºåÂøÖÁà¨Â±ãÈ†ÇÁúãÈ¢®ÊôØ", price: "ÂÖçË≤ª", hours: "Always Open", openRule: "24h" },
                { type: "spot", time: "15:30", name: "Munch Museum (Â≠üÂÖã)", note: "Â∞±Âú®Ê≠åÂäáÈô¢ÊóÅÔºåÁúã„ÄäÂê∂Âñä„Äã", price: "Êàê‰∫∫ 220 NOK", hours: "10:00-21:00", openRule: {s: [10,21]} },
                { type: "food", time: "18:00", name: "Engebret Cafe", note: "Â•ßÊñØÈô∏ÊúÄÂè§ËÄÅÈ§êÂª≥ (ÈÄ±ÂÖ≠17ÈªûÈñã)", price: "‰∏ªÈ§ê 400+ NOK", hours: "17:00-23:00", openRule: {s: [17,23]} }
            ]
        },
        {
            date: "11/30", day: "Sun", loc: "Oslo -> Fl√•m",
            hotel: "Fl√•m Holiday Home",
            items: [
                { type: "transport", time: "08:25", name: "ÁÅ´Ëªä Oslo S -> Myrdal", note: "Êå™Â®ÅÁ∏ÆÂΩ±Á¨¨‰∏ÄÊÆµ", duration: "4h 40m", transport: "Bergensbanen" },
                { type: "transport", time: "13:15", name: "È´òÂ±±ÁÅ´Ëªä Myrdal -> Fl√•m", note: "‰∏ñÁïåÊúÄÁæéÈêµË∑Ø (ÂùêÂè≥ÂÅ¥)", duration: "50m", transport: "Fl√•msbana" },
                { type: "spot", time: "15:00", name: "Stegastein ËßÄÊôØÂè∞", note: "ÈúÄÂú®ÈÅäÂÆ¢‰∏≠ÂøÉÊê≠Â∑¥Â£´Ôºå‰øØÁû∞Â≥ΩÁÅ£", price: "Á¥Ñ 350 NOK", hours: "ÈúÄÊü•Â∑¥Â£´Áè≠Ê¨°", openRule: "24h" },
                { type: "food", time: "18:00", name: "√Ügir BrewPub", note: "Á∂≠‰∫¨È¢®Ê†ºÁ≤æÈáÄÂï§ÈÖíËàáÊôöÈ§ê", price: "Êº¢Â†°Á¥Ñ 250 NOK", hours: "12:00-22:00", openRule: {u: [12,22]} }
            ]
        },
        {
            date: "12/01", day: "Mon", loc: "Fl√•m -> Bergen",
            hotel: "Rosenberg Apartments",
            items: [
                { type: "transport", time: "09:30", name: "Ê∏°Ëº™ Fl√•m -> Gudvangen", note: "Â≥ΩÁÅ£Â∑°Ëà™ (Future of The Fjords)", duration: "2h", transport: "Ferry" },
                { type: "transport", time: "11:30", name: "Â∑¥Â£´ Gudvangen -> Voss", note: "Á∂ì Voss Ê∞¥Ê∫êÂú∞", duration: "1h", transport: "Bus 950" },
                { type: "transport", time: "13:51", name: "ÁÅ´Ëªä Voss -> Bergen", note: "ÊäµÈÅî 14:59", duration: "1h 10m", transport: "Vy Train" },
                { type: "spot", time: "15:30", name: "Bryggen Â∏ÉÂëÇÊ†π", note: "‰∏ñÁïåÈÅ∫Áî¢ÂΩ©Ëâ≤Êú®Â±ã", price: "ÂÖçË≤ª", hours: "Open Area", openRule: "24h" },
                { type: "spot", time: "16:30", name: "Fl√∏ibanen Á∫úËªä", note: "‰∏äÂ±±ÁúãÂçëÁàæÊ†πÂ§úÊôØ (ÈñãÂæàÊôö)", price: "Á¥Ñ 140 NOK", hours: "07:30-23:00", openRule: {w: [7.5, 23]} },
                { type: "food", time: "ÊôöÈ§ê", name: "Trekroneren", note: "ËëóÂêçÁöÑÈ¶¥ÈπøÁÜ±ÁãóÊî§", price: "Á¥Ñ 75 NOK", hours: "11:00-03:00", openRule: {w: [11, 27]} }
            ]
        },
        {
            date: "12/02", day: "Tue", loc: "Bergen -> Helsinki",
            hotel: "VR Night Train (Ëá•Èã™)",
            items: [
                { type: "transport", time: "09:20", name: "È£õÊ©ü AY922 -> Helsinki", note: "ÊäµÈÅî 12:50", duration: "2h 30m", transport: "Finnair" },
                { type: "transport", time: "13:30", name: "Ê©üÂ†¥ -> Â∏ÇÂçÄ", note: "Êê≠ÁÅ´Ëªä I/P Á∑öÂà∞‰∏≠Â§ÆËªäÁ´ô", duration: "30min", transport: "HSL Train" },
                { type: "food", time: "14:00", name: "Old Market Hall (ËÄÅËæ≤Ë≤øÂ∏ÇÂ†¥)", note: "Pho Viet / Soup+More", price: "ÊπØÁ¥Ñ 13 EUR", hours: "08:00-18:00", openRule: {w: [8, 18]} },
                { type: "spot", time: "15:00", name: "Â≤©Áü≥ÊïôÂ†Ç (Temppeliaukio)", note: "ËëóÂêçÁöÑÂ≤©Áü≥‰∏≠ÊïôÂ†Ç", price: "Á¥Ñ 5-8 EUR", hours: "10:00-16:50", openRule: {w: [10, 16.8]} },
                { type: "spot", time: "16:30", name: "ÈùúÈªòÊïôÂ†Ç (Kamppi)", note: "Â∏Ç‰∏≠ÂøÉÊú®Ë£ΩÊïôÂ†Ç", price: "5 EUR", hours: "10:00-18:00", openRule: {w: [10, 18]} },
                { type: "spot", time: "17:30", name: "Oodi ‰∏≠Â§ÆÂúñÊõ∏È§®", note: "ÁµïÁæéÂª∫ÁØâÔºåÂÖçË≤ª‰ºëÊÅØ", price: "ÂÖçË≤ª", hours: "08:00-21:00", openRule: {w: [8, 21]} },
                { type: "food", time: "18:30", name: "Robert's Coffee", note: "ËóçËéìÊ¥æ", price: "Á¥Ñ 8 EUR", hours: "07:30-20:00", openRule: {w: [7.5, 20]} },
                { type: "transport", time: "19:29", name: "Ëá•Èã™ÁÅ´Ëªä -> Rovaniemi", note: "ÂâçÂæÄÂåóÊ•µÂúà", duration: "12hr", transport: "VR Train 265" }
            ]
        },
        {
            date: "12/03", day: "Wed", loc: "Rovaniemi",
            hotel: "Northern Lights Village (Pyh√§)",
            items: [
                { type: "transport", time: "07:20", name: "ÊäµÈÅî Rovaniemi", note: "ÂØÑÊîæË°åÊùéÊàñÁõ¥Êé•ÂéªÊùë", duration: "", transport: "VR Train" },
                { type: "transport", time: "08:00", name: "ÂâçÂæÄËÅñË™ïËÄÅ‰∫∫Êùë", note: "Êê≠ Bus 8 Êàñ Santa's Express", duration: "20min", transport: "Bus 8" },
                { type: "spot", time: "08:30", name: "ËÅñË™ïËÄÅ‰∫∫Êùë", note: "Ë∑®Ë∂äÂåóÊ•µÂúàÁ∑ö„ÄÅÂØÑÊòé‰ø°Áâá", price: "ÂÖ•ÂúíÂÖçË≤ª", hours: "08:00-20:00", openRule: {w: [8, 20]} },
                { type: "spot", time: "13:00", name: "Arktikum Ê•µÂú∞ÂçöÁâ©È§®", note: "ÁéªÁíÉÈï∑Âªä (Êê≠ Bus 8 ÂõûÂ∏ÇÂçÄ)", price: "18 EUR", hours: "10:00-18:00", openRule: {w: [10, 18]} },
                { type: "transport", time: "16:35", name: "Êé•ÈßÅËªä ROV -> Pyh√§", note: "ÂâçÂæÄÊ•µÂÖâÂ∫¶ÂÅáÊùë", duration: "1h 45m", transport: "SkiBus / Hotel Shuttle" },
                { type: "hotel", time: "Night", name: "Northern Lights Village", note: "ÂÖ•‰ΩèÁéªÁíÉÂ±ã", duration: "" }
            ]
        },
        {
            date: "12/04", day: "Thu", loc: "Pyh√§ -> Rovaniemi",
            hotel: "VR Night Train (Ëá•Èã™)",
            items: [
                { type: "spot", time: "10:00", name: "ÊªëÈõ™Ë™≤Á®ã (Skiing)", note: "Pyh√§ ÊªëÈõ™Â†¥", price: "ÈúÄÈ†êÁ¥Ñ", hours: "09:30-19:00", openRule: {w: [9.5, 19]} },
                { type: "spot", time: "14:30", name: "ÂìàÂ£´Â•áÈõ™Ê©á (Husky Safari)", note: "Â∫¶ÂÅáÊùëÊ¥ªÂãï", price: "Á¥Ñ 150 EUR", hours: "ÈúÄÈ†êÁ¥Ñ", openRule: "Reserved" },
                { type: "transport", time: "17:05", name: "Êé•ÈßÅËªä NLV -> Rovaniemi", note: "ËøîÂõûÁÅ´ËªäÁ´ô", duration: "1h 45m", transport: "SkiBus" },
                { type: "transport", time: "21:00", name: "Ëá•Èã™ÁÅ´Ëªä -> Helsinki", note: "VR Train 274", duration: "12hr", transport: "VR Train" }
            ]
        },
        {
            date: "12/05", day: "Fri", loc: "Helsinki",
            hotel: "Helsinki Hotel (Â∏ÇÂçÄ)",
            items: [
                { type: "transport", time: "09:15", name: "ÊäµÈÅî Helsinki", note: "‰∏≠Â§ÆËªäÁ´ô", duration: "", transport: "VR Train" },
                { type: "spot", time: "10:30", name: "Ëµ´ÁàæËæõÂü∫Â∫ßÂ†Ç (ÁôΩÊïôÂ†Ç)", note: "ÂèÉË≠∞Èô¢Âª£Â†¥Âú∞Ê®ô", price: "ÂÖçË≤ª/Ëá™Áî±ÊçêÁçª", hours: "09:00-18:00", openRule: {w: [9, 18]} },
                { type: "spot", time: "11:30", name: "ÁÉèÊñØ‰Ω©ÊñØÂü∫Â§ßÊïôÂ†Ç", note: "Á¥ÖÁ£öÊù±Ê≠£ÊïôÂ†Ç", price: "ÂÖçË≤ª", hours: "09:30-16:00", openRule: {w: [9.5, 16]} },
                { type: "food", time: "12:30", name: "ÂìàÂç°Â∞ºÁ±≥Â∏ÇÂ†¥ (Hakaniemi)", note: "Êê≠ÈõªËªä/Âú∞ÈêµÂâçÂæÄÔºåÂñùÈ≠öÊπØ", price: "Á¥Ñ 12-15 EUR", hours: "08:00-18:00", openRule: {w: [8, 18]} },
                { type: "spot", time: "15:00", name: "L√∂yly Helsinki", note: "Ê°ëÊãøÈ´îÈ©ó (Âº∑ÁÉàÂª∫Ë≠∞È†êÁ¥Ñ)", price: "24 EUR/2h", hours: "13:00-23:00", openRule: {w: [13, 23]} },
                { type: "food", time: "ÊôöÈ§ê", name: "Tawook Lab", note: "‰∏≠Êù±ÊñôÁêÜË©ïÂÉπÈ´ò", price: "15-20 EUR", hours: "11:00-21:00", openRule: {w: [11, 21]} }
            ]
        },
        {
            date: "12/06", day: "Sat", loc: "Helsinki -> Tallinn",
            hotel: "16eur - Fat Margaret's",
            items: [
                { type: "transport", time: "08:00", name: "ÂâçÂæÄË•øÁ¢ºÈ†≠ (West Terminal)", note: "Êê≠ÈõªËªä 7 Êàñ 9 Ëôü", duration: "20min", transport: "Tram 7/9" },
                { type: "transport", time: "09:00", name: "Ê∏°Ëº™ -> Tallinn", note: "Ecker√∂ / Tallink (ÈúÄÊèêÊó© Check-in)", duration: "2h 15m", transport: "Ferry" },
                { type: "hotel", time: "12:00", name: "Check-in ÊîæË°åÊùé", note: "Fat Margaret's Hostel", duration: "" },
                { type: "spot", time: "13:00", name: "Â°îÊûóËÄÅÂüéÂçÄ (Old Town)", note: "Kohtuotsa ËßÄÊôØÂè∞„ÄÅ‰∫ûÊ≠∑Â±±Â§ßÊ∂ÖÂ§´ÊñØÂü∫ÊïôÂ†Ç", price: "ÂÖçË≤ª", hours: "24h", openRule: "24h" },
                { type: "spot", time: "16:00", name: "Â∏ÇÊîøÂª≥Âª£Â†¥ËÅñË™ïÂ∏ÇÈõÜ", note: "Ê≠êÊ¥≤ÊúÄÁæéËÅñË™ïÂ∏ÇÈõÜ", price: "ÂÖçË≤ª", hours: "10:00-20:00", openRule: {s: [10, 20]} },
                { type: "hotel", time: "Night", name: "Fat Margaret's", note: "‰ΩèÂÆø", duration: "" }
            ]
        },
        {
            date: "12/07", day: "Sun", loc: "Tallinn -> Copenhagen",
            hotel: "Generator Copenhagen",
            items: [
                { type: "spot", time: "Morning", name: "Telliskivi ÂâµÊÑèÂúíÂçÄ", note: "ÊñáÈùíÂ∞èÂ∫óËàáÂ°óÈ¥âÁâÜ", price: "ÂÖçË≤ª", hours: "10:00-19:00", openRule: {u: [10, 19]} },
                { type: "transport", time: "13:30", name: "ÂâçÂæÄÂ°îÊûóÊ©üÂ†¥", note: "Êê≠ Tram 4 Êàñ Bolt", duration: "20min", transport: "Tram 4" },
                { type: "transport", time: "15:45", name: "È£õÊ©ü SK1787 -> Copenhagen", note: "ÊäµÈÅî 16:20", duration: "1h 35m", transport: "SAS" },
                { type: "transport", time: "17:00", name: "Ê©üÂ†¥ -> Â∏ÇÂçÄ", note: "ÁÅ´ËªäÊàñÂú∞ÈêµÂà∞ Kongens Nytorv", duration: "20min", transport: "Metro M2" },
                { type: "spot", time: "18:30", name: "Tivoli Gardens", note: "ÂøÖÂéªËÅñË™ïÊ®ÇÂúí (Âª∫Ë≠∞ÂÖàË≤∑Á•®)", price: "ÈñÄÁ•® 160 DKK", hours: "11:00-22:00", openRule: {u: [11, 22]} },
                { type: "hotel", time: "Night", name: "Generator Copenhagen", note: "Èù†Ëøë Kongens Nytorv", duration: "" }
            ]
        },
        {
            date: "12/08", day: "Mon", loc: "Copenhagen",
            hotel: "Generator Copenhagen",
            items: [
                { type: "transport", time: "09:00", name: "ÁÅ´Ëªä -> Helsing√∏r", note: "ÂéªÂìàÂßÜÈõ∑ÁâπÂüéÂ†° (ÊØè20ÂàÜ‰∏ÄÁè≠)", duration: "45min", transport: "Train (Regional)" },
                { type: "spot", time: "10:00", name: "Kronborg (ÂìàÂßÜÈõ∑ÁâπÂüéÂ†°)", note: "‰∏ñÁïåÈÅ∫Áî¢", price: "145 DKK", hours: "10:00-16:00 (ÈÄ±‰∏ÄÂèØËÉΩ‰ºëÈ§®ÔºåÈúÄÁ¢∫Ë™ç)", openRule: {w: [10, 16]} },
                { type: "spot", time: "14:00", name: "Â∞èÁæé‰∫∫È≠ö & Kastellet", note: "Êµ∑ÈÇäË¶ÅÂ°ûÊï£Ê≠•", price: "ÂÖçË≤ª", hours: "24h", openRule: "24h" },
                { type: "spot", time: "16:00", name: "Nyhavn (Êñ∞Ê∏Ø)", note: "ÂΩ©Ëâ≤Â±ãÈÅãÊ≤≥ÔºåÈÅ©ÂêàÊãçÁÖß", price: "ÂÖçË≤ª", hours: "24h", openRule: "24h" },
                { type: "spot", time: "17:30", name: "Str√∏get Ë≥ºÁâ©Ë°ó & LEGO", note: "Ê≠êÊ¥≤ÊúÄÈï∑Ê≠•Ë°åË°ó", price: "ÂÖçË≤ª", hours: "10:00-19:00", openRule: {w: [10, 19]} }
            ]
        },
        {
            date: "12/09", day: "Tue", loc: "Copenhagen -> Bangkok",
            hotel: "Home Sweet Home",
            items: [
                { type: "spot", time: "Morning", name: "ÊúÄÂæåÊé°Ë≤∑ / ÂíñÂï°", note: "Â∏ÇÂçÄÊº´Ê≠•", duration: "2hr" },
                { type: "transport", time: "11:00", name: "ÂâçÂæÄÊ©üÂ†¥", note: "ÊèêÂâçÊäµÈÅî", duration: "30min", transport: "Metro M2" },
                { type: "transport", time: "13:50", name: "È£õÊ©ü TG951 -> Bangkok", note: "Heading home", duration: "", transport: "Thai Airways" }
            ]
        }
    ];

    const container = document.getElementById('itinerary-container');

    async function render() {
        container.innerHTML = '';
        const now = new Date();
        const currentDay = now.getDay(); 
        const currentHour = now.getHours() + now.getMinutes()/60;

        for (let i = 0; i < data.length; i++) {
            const day = data[i];
            const coords = LOCS[day.loc.split('->')[0].trim()] || LOCS["Oslo"];
            const wId = `w-${i}`;
            const aId = `a-${i}`;

            let itemsHtml = '';
            day.items.forEach(item => {
                let statusHtml = '';
                if (item.openRule && item.openRule !== 'Reserved') {
                    const status = checkOpenStatus(item.openRule, currentDay, currentHour);
                    if (status) statusHtml = `<span class="status-text">${status}</span>`;
                }

                const query = encodeURIComponent(item.name + " " + day.loc.split('->')[0]);
                const mapLink = `https://www.google.com/maps/search/?api=1&query=${query}`;
                
                const transportBadge = item.transport ? `<span class="transport-detail">üöå ${item.transport}</span>` : '';
                const priceBadge = item.price ? `<span class="tag price">üí∞ ${item.price}</span>` : '';
                const hoursText = item.hours ? `<span class="hours-info">üïí ÊôÇÈñì: ${item.hours}</span>` : '';

                itemsHtml += `
                <a href="${mapLink}" target="_blank">
                    <div class="item">
                        <div class="time-col">
                            <div class="time">${item.time}</div>
                            <span class="duration">${item.duration || ''}</span>
                        </div>
                        <div class="details-col">
                            <div class="name-row">
                                <span class="name">${item.name}</span>
                                ${statusHtml}
                            </div>
                            <div class="tags">
                                <span class="tag ${item.type}">${getTypeLabel(item.type)}</span>
                                ${priceBadge}
                            </div>
                            ${transportBadge}
                            <div class="note">${item.note}</div>
                            ${hoursText}
                        </div>
                    </div>
                </a>`;
            });

            // ‰ΩèÂÆøÂçÄÂ°ä
            const hotelHtml = day.hotel ? `<div class="hotel-info">üõèÔ∏è ‰ΩèÂÆø: <b>${day.hotel}</b></div>` : '';

            const card = document.createElement('div');
            card.className = 'day-card';
            card.innerHTML = `
                <div class="day-header" onclick="toggleDay(${i})">
                    <div class="day-info">
                        <h2>${day.date} (${day.day})</h2>
                        <div class="day-loc">
                            üìç ${day.loc}
                            <span id="${wId}" class="weather-badge">ËºâÂÖ•‰∏≠...</span>
                            <span id="${aId}" class="aurora-badge" onclick="window.open('https://www.swpc.noaa.gov/products/aurora-30-minute-forecast', '_blank'); event.stopPropagation();">‚ú® Ê•µÂÖâÈ†êÊ∏¨</span>
                        </div>
                        ${hotelHtml}
                    </div>
                    <div style="color:#ccc">‚ñº</div>
                </div>
                <div class="day-content" id="day-${i}" style="display:${i===0?'block':'none'}">
                    ${itemsHtml}
                </div>
            `;
            container.appendChild(card);
            fetchWeather(coords.lat, coords.lon, wId, aId);
        }
    }

    function checkOpenStatus(rule, day, nowHour) {
        if (rule === '24h') return '<span class="status-dot status-open"></span> 24h';
        let range = null;
        if (day >= 1 && day <= 5) range = rule.w || rule.s; 
        else if (day === 6) range = rule.s || rule.w;
        else if (day === 0) range = rule.u || rule.s;
        if (!range) return '';

        const [open, close] = range;
        if (nowHour >= open && nowHour < close) {
            if (close - nowHour < 1) return '<span class="status-dot status-closing"></span> Âø´ÈóúÈñÄ';
            return '<span class="status-dot status-open"></span> ÁáüÊ•≠‰∏≠';
        } else {
            return '<span class="status-dot status-closed"></span> ‰ºëÊÅØ‰∏≠';
        }
    }

    async function fetchWeather(lat, lon, wId, aId) {
        try {
            const url = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true&hourly=cloudcover&forecast_days=1`;
            const res = await fetch(url);
            const data = await res.json();
            
            const temp = Math.round(data.current_weather.temperature);
            const code = data.current_weather.weathercode;
            document.getElementById(wId).innerHTML = `${getWeatherIcon(code)} ${temp}¬∞C`;

            if (lat > 60) {
                const hourIndex = new Date().getHours();
                const cloud = data.hourly.cloudcover[hourIndex] || 0;
                const isNight = data.current_weather.is_day === 0;
                const el = document.getElementById(aId);
                
                if (lat > 64) {
                    el.style.display = 'inline-flex';
                    if (isNight && cloud < 30) {
                        el.innerHTML = "‚ú® Ê•µÂÖâÁéá: È´ò";
                        el.style.background = "#2e7d32";
                    } else if (isNight && cloud < 70) {
                        el.innerHTML = "‚òÅÔ∏è Ê•µÂÖâÁéá: ‰∏≠";
                        el.style.background = "#f57f17"; 
                    } else if (isNight) {
                        el.innerHTML = "üå´Ô∏è Èõ≤Â§™Âéö";
                        el.style.background = "#607d8b";
                    } else {
                        el.style.display = 'none';
                    }
                }
            }
        } catch(e) {}
    }

    function getWeatherIcon(code) {
        if (code === 0) return '‚òÄÔ∏è';
        if (code < 3) return '‚õÖ';
        if (code < 50) return 'üå´Ô∏è';
        if (code < 70) return 'üåßÔ∏è';
        return '‚ùÑÔ∏è';
    }

    function getTypeLabel(type) {
        return { 'transport': '‰∫§ÈÄö', 'food': 'ÁæéÈ£ü', 'spot': 'ÊôØÈªû', 'hotel': '‰ΩèÂÆø' }[type] || type;
    }
    
    function toggleDay(i) {
        const el = document.getElementById(`day-${i}`);
        el.style.display = el.style.display === 'none' ? 'block' : 'none';
    }

    function filterItinerary() {
        const val = document.getElementById('searchInput').value.toLowerCase();
        document.querySelectorAll('.day-card').forEach(card => {
            const match = card.innerText.toLowerCase().includes(val);
            card.style.display = match ? 'block' : 'none';
        });
    }

    render();
</script>

</body>
</html>
